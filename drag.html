<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>拖拽封装</title>
</head>

<style type="text/css">
	body,html,ul,li,button{
		margin: 0;
		padding:0;  
	}

	li,div{
		width: 100px;
		height: 100px;
		display: block;
		background: #eee;
		position: absolute;
		left: 0;
		right: 0;
	}

	button{
		position: fixed;
		left: 0;
		top: 0;
	}
</style>

<body>
	<button id="btn">创建块</button>
	<ul id='container'></ul>
</body>

<script type="text/javascript">
let container = document.getElementById('container');
let btn = document.getElementById('btn');

class Drag {
	constructor(element,content) {
        this.element = element;
        this.content = content;	
        this.disX = 0;
 		this.disY = 0;
<<<<<<< HEAD
 		content.appendChild(element);
        let coloraArr = ['#5c6de7','#ffe58c','#7597de','#ff7b6d'];
        let i = Math.floor(Math.random()*4);
        element.style.background = coloraArr[i];
	}

	dragging() {
		let element = this.element;
		this.dragDown(element);
=======
 		this.dragDown(element);
>>>>>>> 8fb71307a74fbd86088a2d472fc4905d44f3ecf0
	}

	dragDown(element) {
		let that = this;
        console.log(that.element)
        element.onmousedown = function (e) {
            var e = e || window.event;
            //偏移位置 = 元素的X-元素的offset
            that.disX = e.clientX - element.offsetLeft;
            that.disY = e.clientY - element.offsetTop;
            that.dragMove(element);
            that.stopDrag();
            console.log(that.disX,e.clientX - element.offsetLeft);
        }
	}

	dragMove(element) {
		let _this = this;
		let clientWidth = document.documentElement.clientWidth|| document.body.clientWidth;;
		let clientHeight = document.documentElement.clientHeight|| document.body.clientHeight;
		let elementWid = element.offsetWidth;
		let elementHeight = element.offsetHeight;  
		document.onmousemove = function (e) {
            var e = e || window.event;
    	    //元素位置 = 现在鼠标位置 -元素的偏移值
    	   	let left  = e.clientX - _this.disX;
            let top = e.clientY - _this.disY;

            if(left < 0){
            	left = 0;
            	return;
            }

            if(top < 0){
            	top = 0;
            	return;
            }   

            if(left > clientWidth - elementWid){
                left = clientWidth - elementWid;
                return;
            }

            if(top > clientHeight - elementHeight){
                top = clientHeight - elementHeight;
                return;
            }

            element.style.left = left + "px";
            element.style.top =  top + "px";

        }

	}

	stopDrag() {
		document.onmouseup = function () {
		  document.onmousemove = null;
		  document.onmouseup = null;
          return false;
		}
	}	
}


btn.onclick = function () {
  const ele = document.createElement('li');
  container.appendChild(ele);
	new Drag(ele, container);
}

</script>
</html>